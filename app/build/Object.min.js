/*! Object 4.0.0 2017-12-25  WaterTian */

var GAME=GAME||{};GAME.stageWidth=0,GAME.stageHeight=0,GAME.stage=null,GAME.canvas=null,GAME.renderer=null,GAME.SCENE_IN="sceneIn",GAME.SCENE_OUT="sceneOut",GAME.SCENE_IN_COMPLETE="sceneInComplete",GAME.SCENE_OUT_COMPLETE="sceneOutComplete",GAME.ON_ENTER_FRAME="onEnterFrame",GAME.retinaSupport=!0,GAME.imageScale=1,GAME.positionScale=1,GAME.Utils=GAME.Utils||{},GAME.Utils.inherit=function(e,t){e.superClass=t,e.prototype=Object.create(t.prototype),e.prototype.constructor=e},GAME.Utils.extend=function(e,t){if(!t||"object"!=typeof t)return e;for(var n=Object.keys(t),a=n.length;a--;)e[n[a]]=t[n[a]];return e},GAME.Utils.isAndroid=function(){for(var e=navigator.userAgent,t=new Array("Android","SymbianOS","Windows Phone"),n=!1,a=0;a<t.length;a++)if(e.indexOf(t[a])>0){n=!0;break}return n},GAME.Utils.isM2=function(){var e=!1;return navigator.userAgent.indexOf("m2")>0&&(e=!0),e},GAME.EventDispatcher=function(){},GAME.EventDispatcher.prototype={constructor:GAME.EventDispatcher,addEventListener:function(e,t){return this._listeners?this.removeEventListener(e,t):this._listeners={},this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t),t},hasEventListener:function(e,t){var n=this._listeners;return!(!n||!n[e])},removeEventListener:function(e,t){if(this._listeners&&this._listeners[e])for(var n=this._listeners[e],a=0,i=n.length;a<i;a++)if(n[a]==t){1==i?delete this._listeners[e]:n.splice(a,1);break}},removeAllEventListeners:function(e){e?this._listeners&&delete this._listeners[e]:this._listeners=null},dispatchEvent:function(e,t){var n=!1,a=this._listeners;if(e&&a){var i=a[e];if(!i)return n;for(var s=(i=i.slice()).length;s--;){var o=i[s];n=n||o(t)}}return!!n}},GAME.AssetsManager=function(){var e=["assets/assets.json"],t={s1:"sound/s1.mp3",s2:"sound/s2.mp3",s3:"sound/s3.mp3",bg:"sound/bg.mp3"},n=new PIXI.loaders.Loader;this.onComplete=null,this.onProgress=function(e){console.log("加载百分比"+e.progress+"%")},this.start=function(){n.add(e),n.once("complete",this.onComplete),n.on("progress",this.onProgress),n.load(),PIXI.sound.add(t)}},GAME.Scene=function(){PIXI.Container.call(this)},GAME.Utils.inherit(GAME.Scene,PIXI.Container),GAME.Utils.extend(GAME.Scene.prototype,GAME.EventDispatcher.prototype),GAME.Scene.prototype.init=function(){},GAME.Scene.prototype.destroy=function(){},GAME.Scene.prototype.sceneIn=function(){this.dispatchEvent("SCENE_IN")},GAME.Scene.prototype.sceneOut=function(){this.dispatchEvent("SCENE_OUT")},GAME.Scene.prototype.sceneInComplete=function(){this.dispatchEvent("SCENE_IN_COMPLETE")},GAME.Scene.prototype.sceneOutComplete=function(){this.dispatchEvent("SCENE_OUT_COMPLETE")},GAME.GameScene1=function(){GAME.Scene.call(this);var e,t,n,a,i,s,o,r,c,d,l=this;this.init=function(){},this.sceneIn=function(){GAME.Scene.prototype.sceneIn.apply(this),function(){(e=new PIXI.Container).position.x=GAME.stageWidth/2,e.position.y=GAME.stageHeight,l.addChild(e),(d=PIXI.Sprite.fromFrame("t1.png")).anchor.x=.5,e.addChild(d),d.position.y=-GAME.stageHeight,d.alpha=0,TweenMax.to(d,1,{alpha:1,ease:Strong.easeOut,delay:.6}),c=new PIXI.Text("Text1",{font:"50px Helvetica",fill:"#FFFFFF"}),e.addChild(c),c.anchor.x=.5,c.anchor.y=1,c.alpha=0,TweenMax.to(c,1,{alpha:1,ease:Strong.easeOut,delay:1}),TweenMax.to(c.position,1,{y:-460,ease:Elastic.easeOut,delay:.8}),c.rotation=-.05,TweenMax.to(c,.1,{rotation:.1,ease:Linear.easeNone,repeat:-1,yoyo:!0,delay:2});var h=new PIXI.Graphics;h.lineStyle(0),h.beginFill(0,1),h.drawCircle(0,0,50),e.addChild(h),h.position.y=-460,c.mask=h,(n=PIXI.Sprite.fromFrame("pic1.jpg")).anchor.x=.5,n.anchor.y=1,e.addChild(n),n.alpha=0,TweenMax.to(n,1,{alpha:1,ease:Strong.easeOut,delay:1}),TweenMax.to(n.position,1,{y:Math.floor(-350),ease:Elastic.easeOut,delay:1}),(a=PIXI.Sprite.fromFrame("pic2.jpg")).anchor.x=.5,a.anchor.y=1,e.addChild(a),a.alpha=0,TweenMax.to(a,1,{alpha:1,ease:Strong.easeOut,delay:1.2}),TweenMax.to(a.position,1,{y:Math.floor(-210),ease:Elastic.easeOut,delay:1.2}),(o=PIXI.Sprite.fromFrame("btn1.png")).anchor.x=.5,o.anchor.y=1,e.addChild(o),o.alpha=0,TweenMax.to(o,1,{alpha:1,ease:Strong.easeOut,delay:1.4}),TweenMax.to(o.position,1,{y:-20,ease:Elastic.easeOut,delay:1.4}),o.interactive=!0,o.mousedown=o.touchstart=function(){TweenMax.to(e,.4,{alpha:0,onComplete:function(){l.removeChild(e),e=null}}),PIXI.sound.play("s2"),t=new PIXI.Container,l.addChild(t),(i=PIXI.Sprite.fromFrame("pic4.jpg")).position.x=0,i.position.y=100,t.addChild(i),i.alpha=0,TweenMax.to(i,.6,{alpha:1}),(s=PIXI.Sprite.fromFrame("pic5.png")).anchor.x=.5,s.anchor.y=.5,s.position.x=GAME.stageWidth/2,s.position.y=GAME.stageHeight/2,t.addChild(s),s.scale.x=s.scale.y=0,TweenMax.to(s.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:.8}),(r=PIXI.Sprite.fromFrame("btn2.jpg")).anchor.x=.5,r.anchor.y=.5,r.position.x=GAME.stageWidth/2,r.position.y=s.position.y+240,t.addChild(r),r.scale.x=r.scale.y=0,TweenMax.to(r.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:.9}),r.interactive=!0,r.mousedown=r.touchstart=function(){l.sceneOut()}}}(),!0},this.update=function(){};this.sceneOut=function(){GAME.Scene.prototype.sceneOut.apply(this),TweenMax.to(this,.4,{alpha:0,onComplete:function(){l.sceneOutComplete()}})}},GAME.Utils.inherit(GAME.GameScene1,GAME.Scene),GAME.GameScene2=function(){GAME.Scene.call(this);var e,t,n,a,i,s,o,r=this,c=!1;this.init=function(){},this.sceneIn=function(){GAME.Scene.prototype.sceneIn.apply(this),function(){(e=new PIXI.Container).x=GAME.stageWidth/2,e.y=GAME.stageHeight/2,r.addChild(e),(t=PIXI.Sprite.fromFrame("pic6.jpg")).anchor.x=.5,e.addChild(t),t.alpha=0,TweenMax.to(t,1,{alpha:1,ease:Strong.easeOut,delay:.6}),TweenMax.to(t,1,{y:-300,ease:Elastic.easeOut,delay:.6}),(n=PIXI.Sprite.fromFrame("pic7.png")).anchor.x=.5,n.anchor.y=.5,e.addChild(n),n.scale.x=n.scale.y=0,TweenMax.to(n.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:.8}),(a=PIXI.Sprite.fromFrame("pic8.png")).anchor.x=.5,a.anchor.y=.5,e.addChild(a),a.x=-134,a.y=-58,a.scale.x=a.scale.y=0,TweenMax.to(a.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:.9}),(i=PIXI.Sprite.fromFrame("pic9.png")).anchor.x=.5,i.anchor.y=.5,e.addChild(i),i.x=-54,i.y=-128,i.scale.x=i.scale.y=0,TweenMax.to(i.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:1}),(s=PIXI.Sprite.fromFrame("pic10.png")).anchor.x=.5,s.anchor.y=.5,e.addChild(s),s.x=61,s.y=-128,s.scale.x=s.scale.y=0,TweenMax.to(s.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:1.1}),(o=PIXI.Sprite.fromFrame("pic11.png")).anchor.x=.5,o.anchor.y=.5,e.addChild(o),o.x=134,o.y=-58,o.scale.x=o.scale.y=0,TweenMax.to(o.scale,1,{x:1,y:1,ease:Elastic.easeOut,delay:1.2}),d=new PIXI.ParticleContainer(1e4,{scale:!0,position:!0,alpha:!0}),r.addChild(d);for(var c=0;c<4;c++){var l=new PIXI.Sprite(PIXI.Texture.fromFrame("pic7.png"));l.interactive=!0,l.buttonMode=!0,l.anchor.set(.5),l.on("mousedown",p).on("touchstart",p).on("mouseup",u).on("mouseupoutside",u).on("touchend",u).on("touchendoutside",u).on("mousemove",E).on("touchmove",E),l.x=Math.floor(200*Math.random()),l.y=Math.floor(200*Math.random()),r.addChild(l),h(l)}}(),c=!0},this.update=function(){c&&function(){for(var e=0;e<l.length;e++){var t=l[e];t.alpha-=t.Aspeed,t.x+=t.Xspeed,t.y+=t.Yspeed,t.alpha<=0&&(t.x=t.parentObject.x,t.y=t.parentObject.y,t.alpha=1)}}()};var d,l=[];function h(e){for(var t=0;t<100;++t){var n=new PIXI.Sprite.fromFrame("star.png");n.anchor.set(.5),n.scale.set(Math.random()+1),n.x=e.x,n.y=e.y,n.parentObject=e,n.Xspeed=2*Math.random()-1,n.Yspeed=2*Math.random()-1,n.Aspeed=.01+.1*Math.random(),l.push(n),d.addChild(n)}}function p(e){this.data=e.data,this.alpha=.99,this.dragging=!0,this.id=this.data.identifier}function u(e){e.data.identifier==this.id&&(this.alpha=1,this.dragging=!1,this.data=null,this.id=null)}function E(e){if(e.data.identifier==this.id&&this.dragging){var t=this.data.getLocalPosition(this.parent);this.x=t.x,this.y=t.y}}this.sceneOut=function(){}},GAME.Utils.inherit(GAME.GameScene2,GAME.Scene);var view,stage,renderer,gameScene,assetsManager,logo,stats,winWidth,winHeight;$(function(){$(window).resize(resizeCanvas),resizeCanvas(),init(),initStatsBar()});function resizeCanvas(){winWidth=$(window).get(0).innerWidth||document.documentElement.clientWidth||document.body.clientWidth,(winHeight=$(window).get(0).innerHeight||document.documentElement.clientHeight||document.body.clientHeight)>winWidth&&!view&&$("html,body").scrollLeft(0)}function initStatsBar(){stats=new Stats,document.body.appendChild(stats.domElement)}function init(){window.devicePixelRatio;GAME.stageWidth=640,GAME.stageHeight=640*winHeight/winWidth,(view=document.getElementById("pixi_view")).style.width=winWidth+"px",view.style.height=winHeight+"px",renderer=new PIXI.Application({width:GAME.stageWidth,height:GAME.stageHeight,view:view,transparent:!0}),stage=new PIXI.Container,renderer.stage.addChild(stage),GAME.renderer=renderer,GAME.canvas=view,GAME.stage=stage,(assetsManager=new GAME.AssetsManager).onComplete=function(){TweenMax.to(document.getElementById("loading"),1,{css:{alpha:0}}),TweenMax.delayedCall(1,function(){$("#loading").hide()}),initScene()},assetsManager.start(),animate()}function initScene(){var e=PIXI.Sprite.fromFrame("logo2.png");stage.addChild(e),initScene1(),PIXI.sound.play("bg",{loop:!0})}function initScene1(){PIXI.sound.play("s1"),gameScene=new GAME.GameScene1,stage.addChild(gameScene),gameScene.init(),gameScene.sceneIn(),gameScene.addEventListener("SCENE_OUT_COMPLETE",function(e){stage.removeChild(gameScene),gameScene=null,initScene2()})}function initScene2(){PIXI.sound.play("s3"),gameScene=new GAME.GameScene2,stage.addChild(gameScene),gameScene.init(),gameScene.sceneIn(),gameScene.addEventListener("SCENE_OUT_COMPLETE",function(e){stage.removeChild(gameScene),gameScene=null})}function animate(){requestAnimationFrame(animate),GAME.renderer.render(GAME.stage),stats&&stats.update(),gameScene&&gameScene.update()}