var renderer,    stage,    gameScene,    assetsManager,    stats,    adaptiveModel;$(document).ready(function(){    document.addEventListener('touchmove', function(event){event.preventDefault();}, false);    var dpr = window.devicePixelRatio || 1;    var iis=1/dpr;    $("#viewport")[0].content="width=device-width,initial-scale="+iis.toString()+" minimum-scale="+iis.toString()+", maximum-scale="+iis.toString();    $(window).on('resize',resizeCanvas);    resizeCanvas();});function resizeCanvas(){    var winWidth=document.documentElement.clientWidth||document.body.clientWidth,        winHeight=document.documentElement.clientHeight||document.body.clientHeight;    switch (GAME.adaptiveModel){        /*         * 适应模式a         * 根据高度，自适应宽度，高度100%显示，宽度左右自适应。         * */        case "a":            GAME.stageHeight=winHeight;            GAME.stageWidth=winHeight/1008*640;            break;        /*         * 适应模式b         * 根据宽度，自适应高度，宽度100%显示，高度上下自适应。         * */        case "b":            GAME.stageWidth=winWidth;            GAME.stageHeight=winWidth/640*1008;            break;        /*         * 适应模式ab         * 当屏幕的宽高比例大于初始化比例 用自适应模式a  反之则用自适应模式b         * */        case "ab":            //设计搞的初始比例            var initProportion=640/1008;            if((winWidth/winHeight)>initProportion){                GAME.stageHeight=winHeight;                GAME.stageWidth=winHeight/1008*640;            }else{                GAME.stageWidth=winWidth;                GAME.stageHeight=winWidth/640*1008;            }            break;        /*         * 适应模式full         * 舞台的宽高=屏幕的宽高         * */        case "full":            GAME.stageWidth=winWidth;            GAME.stageHeight=winHeight;            break;        /*         * 适应模式topLeft         *根据宽度，自适应高度，宽度100%显示，舞台居左上对齐         * */        case "topLeft":            GAME.stageWidth=winWidth;            GAME.stageHeight=winWidth/640*1008;            break;    }    console.log("resize w:"+winWidth+"  h:"+winHeight);    if(GAME.stageWidth>GAME.stageHeight)    {        $("#landscape").show();        return;    }else        $("#landscape").hide();    if(GAME.canvas)    {        GAME.canvas.style.height=GAME.stageHeight+"px";        GAME.canvas.style.width=GAME.stageWidth+"px";        $("html,body").scrollLeft(0);        return;    }    setTimeout(function(){        if(GAME.canvas)return;        init();        initStatsBar();    },100);}function initStatsBar(){    stats = new Stats();    stats.domElement.style.position = 'absolute';    stats.domElement.style.top = '0px';    document.body.appendChild(stats.domElement);};function init(){    renderer = PIXI.autoDetectRenderer(GAME.stageWidth, GAME.stageHeight,{backgroundColor : 0x1099bb});    renderer.view.className=adaptiveModel;    document.body.appendChild(renderer.view);    stage = new PIXI.Container();    GAME.renderer = renderer;    GAME.canvas = renderer.view;    GAME.stage = stage;    GAME.imageScale = GAME.stageWidth/640;    GAME.positionScale=1*GAME.imageScale;    /////////////////    assetsManager=new GAME.AssetsManager();    assetsManager.onComplete=function()    {        TweenMax.to(document.getElementById("loading"),1,{css:{alpha:0}});        TweenMax.delayedCall(1,function()        {            $("#loading").hide();        });        initScene();    };    /////////////////initSound    var sounds = [    {src: "sound/bg.mp3", id: "bg"},    {src: "sound/s1.mp3", id: "s1"},    {src: "sound/s2.mp3", id: "s2"},    {src: "sound/s3.mp3", id: "s3"}    ];    H5Sound.load(sounds,soundLoadComplete);    function soundLoadComplete()    {        H5Sound.play("bg",0);        assetsManager.start();        animate();    }    //////////////}function initScene(){    var _logo = PIXI.Sprite.fromFrame("logo2.png");    _logo.scale.set(GAME.imageScale);    _logo.x=GAME.stageWidth-_logo.width;    stage.addChild(_logo);    var _btn1= new PIXI.Text("Scene1", { font: "26px Helvetica", fill: "#000" });    _btn1.anchor.y=1;    _btn1.y=GAME.stageHeight;    _btn1.x=100*GAME.positionScale;    stage.addChild(_btn1);    var _btn2= new PIXI.Text("Scene2", { font: "26px Helvetica", fill: "#000" });    _btn2.anchor.y=1;    _btn2.y=GAME.stageHeight;    _btn2.x=300*GAME.positionScale;    stage.addChild(_btn2);    var _btn3= new PIXI.Text("Scene3", { font: "26px Helvetica", fill: "#000" });    _btn3.anchor.y=1;    _btn3.y=GAME.stageHeight;    _btn3.x=500*GAME.positionScale;    stage.addChild(_btn3);    _btn1.interactive = true;    _btn1.mousedown = _btn1.touchstart = function ()    {        removeSceneTo(1);    }    _btn2.interactive = true;    _btn2.mousedown = _btn2.touchstart = function ()    {        removeSceneTo(2);    }    _btn3.interactive = true;    _btn3.mousedown = _btn3.touchstart = function ()    {        removeSceneTo(3);    }    initScene3();}function removeSceneTo(num){    if(gameScene)    {        gameScene.sceneOut();        gameScene.addEventListener(GAME.SCENE_OUT_COMPLETE,function(e)        {            stage.removeChild(gameScene);            gameScene=null;            if(num==1)initScene1();            if(num==2)initScene2();            if(num==3)initScene3();        });    }}function initScene1(){    H5Sound.play("s1",1);    gameScene=new GAME.GameScene1();    stage.addChildAt(gameScene,0);    gameScene.init();    gameScene.sceneIn();    gameScene.addEventListener(GAME.GO_SCENE3,function(e)    {        console.log(e);        removeSceneTo(3);    });}function initScene2(){    H5Sound.play("s3",1);    gameScene=new GAME.GameScene2();    stage.addChildAt(gameScene,0);    gameScene.init();    gameScene.sceneIn();}function initScene3(){    gameScene=new GAME.GameScene3();    stage.addChildAt(gameScene,0);    gameScene.init();    gameScene.sceneIn();}function animate(){    requestAnimationFrame(animate);    renderer.render(stage);    if(stats)stats.update();    if(gameScene)gameScene.update();};